<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:ui="jakarta.faces.facelets"
        xmlns:h="jakarta.faces.html"
        xmlns:f="jakarta.faces.core"
        xmlns:p="http://primefaces.org/ui"
        xmlns:ues="jakarta.faces.composite/ues"
        template="/WEB-INF/plantilla/default.xhtml">

    <!-- recibe el parametro-->
    <f:metadata>
        <f:viewParam name="archivoId" value="#{transaccionFrm.idArchivoSeleccionado}" />
        <f:viewAction action="#{transaccionFrm.cargarTransaccionesDelArchivo}" />
    </f:metadata>

    <ui:define name="header">
        <h1>Gestión de Transacciones</h1>
    </ui:define>

    <!-- tabla de transaccions-->
    <ui:define name="contenido-tabla">
        <h:panelGrid>
            <h:form id="frmTablaTransacciones">

                <p:dataTable lazy="true"
                             rendered="#{transaccionFrm.estado == 'NADA'}"
                             rows="10"
                             paginator="true"
                             paginatorPosition="bottom"
                             value="#{transaccionFrm.modelo}"
                             var="t"
                             selectionMode="single"
                             selection="#{transaccionFrm.registro}"
                             styleClass="tabla-crud">

                    <p:ajax event="rowSelect"
                            listener="#{transaccionFrm.seleccionarRegistro}"
                            update=":pnlDetalle :pnlTabla"/>

                    <p:column headerText="Fecha">
                        <h:outputText value="#{t.fecha}">
                            <f:convertDateTime pattern="dd/MM/yyyy" />
                        </h:outputText>
                    </p:column>

                    <p:column headerText="Descripción">
                        <h:outputText value="#{t.descripcion}"/>
                    </p:column>

                    <p:column headerText="Monto">
                        <h:outputText value="$#{t.monto}"/>
                    </p:column>

                    <p:column headerText="Moneda">
                        <h:outputText value="#{t.moneda}"/>
                    </p:column>

                </p:dataTable>

                <ues:botones-top formulario="#{transaccionFrm}" actualizar=":pnlDetalle :pnlTabla"/>

            </h:form>
        </h:panelGrid>
    </ui:define>

    <!-- detalle de la transaccion -->
    <ui:define name="contenido-detalle">

        <p:tabView id="tabTransaccion"
                   cache="false"
                   dynamic="true"
                   rendered="#{transaccionFrm.estado != 'NADA'}">

            <p:tab closable="false" title="Detalle de transacción">

                <h:panelGroup id="pnlTransaccionWrapper">
                    <h:form id="frmTransaccionCrear">

                        <h:panelGrid columns="2">

                            <p:outputLabel for="txtIdTrans" value="ID:"/>
                            <p:inputText id="txtIdTrans"
                                         value="#{transaccionFrm.registro.id}"
                                         readonly="true"
                                         disabled="true"/>

                            <p:outputLabel for="dpFechaTrans" value="Fecha:"/>
                            <p:datePicker id="dpFechaTrans"
                                          value="#{transaccionFrm.registro.fecha}"
                                          pattern="yyyy-MM-dd"
                                          required="true"
                                          showIcon="true"
                                          touchUI="false"/>

                            <p:outputLabel for="txtDescripcion" value="Descripción:"/>
                            <p:inputTextarea id="txtDescripcion"
                                             value="#{transaccionFrm.registro.descripcion}"
                                             rows="3" cols="30"
                                             required="true"
                                             requiredMessage="La descripción es obligatoria."/>

                            <p:outputLabel for="txtMonto" value="Monto:"/>
                            <p:inputNumber id="txtMonto"
                                           value="#{transaccionFrm.registro.monto}"
                                           symbol="$"
                                           required="true"/>

                            <p:outputLabel for="cmbMoneda" value="Moneda:"/>
                            <p:selectOneMenu id="cmbMoneda"
                                             value="#{transaccionFrm.registro.moneda}">
                                <f:selectItem itemLabel="USD" itemValue="USD"/>
                            </p:selectOneMenu>

                        </h:panelGrid>

                        <ues:botones-crud
                                formulario="#{transaccionFrm}"
                                actualizar=":pnlTabla :tabTransaccion"/>

                    </h:form>
                </h:panelGroup>

            </p:tab>

            <!-- clasificacion cuenta contable -->
            <p:tab  closable="false" title="Clasificación Contable" disabled="#{transaccionFrm.estado != 'MODIFICAR'}">

                <h:form id="frmClasificacion">
                    <!-- transaccion seleccionada-->
                    <p:panel header="Transacción Seleccionada">
                        <h:panelGrid columns="2">

                            <h:outputLabel value="ID Transacción:"/>
                            <h:outputText value="#{transaccionFrm.registro.id}"/>

                            <h:outputLabel value="Descripción:"/>
                            <h:outputText value="#{transaccionFrm.registro.descripcion}"/>

                            <h:outputLabel value="Monto:"/>
                            <h:outputText value="$#{transaccionFrm.registro.monto}"/>

                            <h:outputLabel value="Moneda:"/>
                            <h:outputText value="#{transaccionFrm.registro.moneda}"/>


                        </h:panelGrid>
                    </p:panel>

                    <br/>

                    <!-- ===== hasta aqui revisado  ===== -->
                    <p:panel header="Clasificación contable">

                        <p:panelGrid columns="2">

                            <!-- Tipo de transacción -->
                            <h:outputLabel value="Tipo de transacción:"/>

                            <!-- Categoría -->
                            <h:outputLabel value="Categoría:"/>

                            <!-- Cuenta debe -->
                            <h:outputLabel value="Cuenta contable - Debe:"/>

                            <!-- Cuenta haber -->
                            <h:outputLabel value="Cuenta contable - Haber:"/>



                        </p:panelGrid>

                    </p:panel>

                </h:form>

            </p:tab>




        </p:tabView>

    </ui:define>

</ui:composition>
